program SPFA;
const
   MAXN	= 10000;
   INF	=  20000000;
var
   n,m : longint;
   w   : array[ 1..MAXN , 1..MAXN ] of longint;
   q   : array[ 1..3*MAXN ] of longint;